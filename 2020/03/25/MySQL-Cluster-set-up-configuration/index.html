<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>部署MySQL Cluster集群系统 | DreamHacker</title><meta name="keywords" content="mysql,Cluster"><meta name="author" content="Purplezi"><meta name="copyright" content="Purplezi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL Cluster is a technology providing shared-nothing clustering and auto-sharding for the MySQL database management system.It is designed to provide high availability and high throughput with low l">
<meta property="og:type" content="article">
<meta property="og:title" content="部署MySQL Cluster集群系统">
<meta property="og:url" content="https://purplezi.github.io/2020/03/25/MySQL-Cluster-set-up-configuration/index.html">
<meta property="og:site_name" content="DreamHacker">
<meta property="og:description" content="MySQL Cluster is a technology providing shared-nothing clustering and auto-sharding for the MySQL database management system.It is designed to provide high availability and high throughput with low l">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://purplezi.github.io/img/bg2.jpg">
<meta property="article:published_time" content="2020-03-25T11:31:59.000Z">
<meta property="article:modified_time" content="2021-04-14T02:53:22.082Z">
<meta property="article:author" content="Purplezi">
<meta property="article:tag" content="mysql">
<meta property="article:tag" content="Cluster">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://purplezi.github.io/img/bg2.jpg"><link rel="shortcut icon" href="/img/icon1.png"><link rel="canonical" href="https://purplezi.github.io/2020/03/25/MySQL-Cluster-set-up-configuration/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-14 02:53:22'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="DreamHacker" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="DreamHacker" type="application/rss+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> Books</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fas fa-images"></i><span> Photo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/bg2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">DreamHacker</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> Books</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li><li><a class="site-page" href="/photos/"><i class="fa-fw fas fa-images"></i><span> Photo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">部署MySQL Cluster集群系统</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-03-25T11:31:59.000Z" title="Created 2020-03-25 11:31:59">2020-03-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-04-14T02:53:22.082Z" title="Updated 2021-04-14 02:53:22">2021-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/DataBase/">DataBase</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>MySQL Cluster is a technology providing <strong>shared-nothing</strong> clustering and auto-sharding for the MySQL database management system.<br>It is designed to provide high availability and high throughput with low latency, while allowing for near linear scalability<br>A MySQL Cluster consists of one or more management nodes (ndb_mgmd) that store the cluster’s configuration and control the data nodes (ndbd), where cluster data is stored.<br>After communicating with the management node, clients (MySQL clients, servers, or native APIs) connect directly to these data nodes.<br>With MySQL Cluster there is typically no replication of data, but instead data node synchronization. For this purpose a special data engine must be used — NDBCluster (NDB)</p>
</blockquote>
<a id="more"></a>

<h2 id="1-实验环境"><a href="#1-实验环境" class="headerlink" title="1 实验环境"></a>1 实验环境</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-create-a-multi-node-mysql-cluster-on-ubuntu-18-04">英文指南(18.04&amp;16.04)</a></li>
<li>VMware Workstation Pro 12</li>
<li>2台Linux虚拟机，Ubuntu 16.04 Server</li>
<li><a target="_blank" rel="noopener" href="http://dev.mysql.com/downloads/cluster/">MySQL-Cluster的安装包</a>：mysql-cluster_8.0.19-1ubuntu16.04_amd64.deb-bundle.tar</li>
<li>设置windows主机和Linux虚拟机共享文件夹</li>
<li>方便编辑配置文件，安装vim <code>sudo apt-get install vim</code></li>
</ul>
<h2 id="2-实验过程"><a href="#2-实验过程" class="headerlink" title="2 实验过程"></a>2 实验过程</h2><h3 id="2-1-前提"><a href="#2-1-前提" class="headerlink" title="2.1 前提"></a>2.1 前提</h3><ul>
<li><p><a href="#%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE">在VMware下安装Ubuntu虚拟机</a></p>
</li>
<li><p>VMware的克隆，右键虚拟机-&gt;管理-&gt;克隆，创建完整克隆</p>
<ul>
<li><p>两个不同的虚拟机如果是用同一个镜像报错内部错误 -&gt; 就像virtualbox中的多重加载</p>
</li>
<li><p>所以用一个iso安装好一个虚拟机后，将使用ISO映像文件去掉，选择使用物理驱动器。再用这个iso装另外的机器。克隆同理。</p>
<img src="iso.png"></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/happysunshineguy/article/details/77158993?utm_source=copy">虚拟机与宿主机共享</a></p>
<ul>
<li>注意用<code>cp</code>而不是<code>mv</code>将vmware tools安装包移动到可以进行解压<code>gunzip</code>的目录，如’/root’。因为该安装包只读，所以无法在该文件夹下进行解压和<code>mv</code>命令</li>
<li>tar格式(tar是打包，不是压缩)<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">打包:tar cvf 目录文件名.tar 目录文件名</span><br><span class="line">解包:tar xvf 目录文件名.tar</span><br></pre></td></tr></table></figure></li>
<li>tar.gz格式：<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">压缩:tar -zcvf 目录文件名.tar.gz 目录文件名</span><br><span class="line">解压:tar -zxvf 目录文件名.tar.gz</span><br></pre></td></tr></table></figure>
<h3 id="2-2-设置静态IP"><a href="#2-2-设置静态IP" class="headerlink" title="2.2 设置静态IP"></a>2.2 设置静态IP</h3></li>
</ul>
</li>
</ul>
<h4 id="2-2-1-VMware配置网络环境"><a href="#2-2-1-VMware配置网络环境" class="headerlink" title="2.2.1 VMware配置网络环境"></a>2.2.1 VMware配置网络环境</h4><ul>
<li><p>按要求给一台机器设置静态ip为：192.168.50.128，另一台机器的静态ip为：192.168.50.129。</p>
</li>
<li><p>使用NAT，虚拟机在一个子网中，通过物理机的IP上网。</p>
<img src="delete-VMnet01.png" width=80%></li>
<li><p>去掉<code>使用本地DHCP服务将IP地址分配给虚拟机</code>，并且设置子网IP为：192.168.50.0，子网掩码为：255.255.255.0。因此，在Ubuntu中，设置IP地址的时候，可以设置为192.168.50.x，x可以为1~255。</p>
<img src="dhcp-ipaddress.png" width=80%></li>
<li><p>选择<code>NAT设置</code>，打开NAT设置面板，查看网关地址。</p>
<img src="gatewayaddress.png"></li>
<li><p>在VMWare的虚拟机管理界面，选择Ubuntu的<code>编辑虚拟机设置</code>，打开Ubuntu这个虚拟的设置界面。选择网络适配器，然后确定网络连接选中的是<code>自定义</code>中的VMnet8(NAT模式)。</p>
<img src="VMnet8.png"></li>
</ul>
<h4 id="2-2-2-为Ubuntu设置静态IP地址"><a href="#2-2-2-为Ubuntu设置静态IP地址" class="headerlink" title="2.2.2 为Ubuntu设置静态IP地址"></a>2.2.2 为Ubuntu设置静态IP地址</h4><h5 id="通过Terminal命令行来设置IP地址"><a href="#通过Terminal命令行来设置IP地址" class="headerlink" title="通过Terminal命令行来设置IP地址"></a>通过Terminal命令行来设置IP地址</h5><ul>
<li><p>在命令行输入</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vi &#x2F;etc&#x2F;network&#x2F;interfaces </span><br><span class="line"></span><br><span class="line"># 在打开的文件中，若有内容，先全部删除</span><br><span class="line"># 然后输入如下代码</span><br><span class="line"># ip a查看网卡信息是ens33</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line">auto ens33</span><br><span class="line">iface ens33 inet static</span><br><span class="line">address 192.168.50.128</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.50.2</span><br></pre></td></tr></table></figure>
<img src="configureIPaddress.png"></li>
<li><p>配置DNS服务器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vi &#x2F;etc&#x2F;resolv.conf</span><br><span class="line"></span><br><span class="line"># 在里面填入阿里的DNS：223.5.5.5</span><br><span class="line">nameserver 223.5.5.5</span><br><span class="line"></span><br><span class="line"># 在命令行中输入：</span><br><span class="line">sudo &#x2F;etc&#x2F;init.d&#x2F;networking restart </span><br></pre></td></tr></table></figure>
<img src="configuredns.png"></li>
<li><p>重复以上步骤，配置第二个虚拟机的静态IP地址。</p>
</li>
</ul>
<h3 id="2-3-集群配置"><a href="#2-3-集群配置" class="headerlink" title="2.3 集群配置"></a>2.3 集群配置</h3><h4 id="2-3-1-集群配置要求"><a href="#2-3-1-集群配置要求" class="headerlink" title="2.3.1 集群配置要求"></a>2.3.1 集群配置要求</h4><ul>
<li><p>拓扑图</p>
<img src="MySQLCluster.png"></li>
<li><p>集群配置要求</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ndbd：MySQL data nodes</span><br><span class="line"># ndb_mgmd：server for the Cluster Manager</span><br><span class="line"># mysqld and mysql：MySQL server&#x2F;client </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>节点</th>
<th>IP address</th>
<th>运行实例</th>
<th>nodeID</th>
</tr>
</thead>
<tbody><tr>
<td>数据节点1</td>
<td>192.168.50.128</td>
<td>ndbd</td>
<td>11</td>
</tr>
<tr>
<td>数据节点2</td>
<td>192.168.50.129</td>
<td>ndbd</td>
<td>12</td>
</tr>
<tr>
<td>管理节点</td>
<td>192.168.50.129</td>
<td>ndb_mgmd</td>
<td>1</td>
</tr>
<tr>
<td>sql节点1</td>
<td>192.168.50.129</td>
<td>mysqld</td>
<td>13</td>
</tr>
<tr>
<td>sql节点2</td>
<td>192.168.50.128</td>
<td>mysqld</td>
<td>14</td>
</tr>
</tbody></table>
<ul>
<li><p>一般配置，数据节点和管理节点分离(需要3台虚拟机模拟实现)。由于此处只用了2台虚拟机。</p>
<img src="common.png"></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="http://dev.mysql.com/downloads/cluster/">MySQL-Cluster的安装包下载</a>，根据linux操作系统选择正确的版本</p>
</li>
<li><p>若之前安装过mysql-server，需要将mysql-server卸载</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 执行以下指令卸载mysql</span><br><span class="line">sudo apt-get autoremove --purge mysql-server</span><br><span class="line">sudo apt-get remove mysql-server</span><br><span class="line">sudo apt-get autoremove mysql-server</span><br><span class="line">sudo apt-get remove mysql-common </span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-准备阶段"><a href="#2-3-2-准备阶段" class="headerlink" title="2.3.2 准备阶段"></a>2.3.2 准备阶段</h4></li>
<li><p>针对<code>192.168.50.129</code>，安装</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 在命令行下</span><br><span class="line">sudo adduser mysql</span><br><span class="line">sudo usermod -aG sudo mysql</span><br></pre></td></tr></table></figure>
<img src="adduser.png">

<img src="usermod.png"></li>
<li><p>把下载的mysql-cluster_8.0.19-1ubuntu16.04_amd64.deb-bundle.tar从windows共享给虚拟机(通过共享文件夹)</p>
</li>
<li><p>将MySQL-Cluster的安装包放入虚拟机的指定目录install文件夹，操作如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 在命令行的根目录下</span><br><span class="line">mkdir install</span><br><span class="line"># 通过共享文件夹</span><br><span class="line">tar -xvf &#x2F;mnt&#x2F;hgfs&#x2F;xxx&#x2F;mysql-cluster_8.0.19-1ubuntu16.04_amd64.deb-bundle.tar -C install&#x2F;</span><br><span class="line">cd install</span><br></pre></td></tr></table></figure>
<img src="install.png"></li>
<li><p>安装<code>MySQL server binary</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 安装依赖包</span><br><span class="line">sudo apt update</span><br><span class="line"># sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line"></span><br><span class="line">sudo apt-get install libaio1 libmecab2</span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-安装配置集群管理器"><a href="#2-3-3-安装配置集群管理器" class="headerlink" title="2.3.3 安装配置集群管理器"></a>2.3.3 安装配置集群管理器</h4></li>
<li><p>用dpkg指令在Cluster Manager 服务器(为<strong>192.168.50.129</strong>)上安装ndb_mgmd</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 进入install目录</span><br><span class="line">sudo dpkg -i mysql-cluster-community-management-server_8.0.19-1ubuntu16.04_amd64.deb</span><br></pre></td></tr></table></figure>
<img src="dpkg.png"></li>
<li><p>在第一次运行ndb_mgmd前需要对其进行配置，正确配置是保证数据节点正确同步和负载分配的前提。</p>
</li>
<li><p>Cluster Manager 应该是MySQL Cluster 第一个启动的组件.它需要一个配置文件来加载参数. 我门创建配置文件: /var/lib/mysql-cluster/config.ini.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 从Windows编辑config.ini可能会报错，需要在Linux系统下编辑</span><br><span class="line"># 在Cluster Manager 所在机器上创建 &#x2F;var&#x2F;lib&#x2F;mysql-cluster目录:</span><br><span class="line">sudo mkdir &#x2F;var&#x2F;lib&#x2F;mysql-cluster</span><br><span class="line"></span><br><span class="line">sudo vim &#x2F;var&#x2F;lib&#x2F;mysql-cluster&#x2F;config.ini</span><br><span class="line"></span><br><span class="line"># 内容如下</span><br><span class="line">[ndbd default]</span><br><span class="line"># Options affecting ndbd processes on all data nodes:</span><br><span class="line">NoOfReplicas&#x3D;2  # Number of replicas</span><br><span class="line"></span><br><span class="line">[ndb_mgmd]</span><br><span class="line"># Management process options:</span><br><span class="line">hostname&#x3D;192.168.50.129  # Hostname of the manager</span><br><span class="line">NodeId&#x3D;1</span><br><span class="line">datadir&#x3D;&#x2F;var&#x2F;lib&#x2F;mysql-cluster  # Directory for the log files</span><br><span class="line"></span><br><span class="line">[ndbd]</span><br><span class="line">hostname&#x3D;192.168.50.128 # Hostname&#x2F;IP of the first data node</span><br><span class="line">NodeId&#x3D;11            # Node ID for this data node</span><br><span class="line">datadir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data   # Remote directory for the data files</span><br><span class="line"></span><br><span class="line">[ndbd]</span><br><span class="line">hostname&#x3D;192.168.50.129 # Hostname&#x2F;IP of the second data node</span><br><span class="line">NodeId&#x3D;12            # Node ID for this data node</span><br><span class="line">datadir&#x3D;&#x2F;usr&#x2F;local&#x2F;mysql&#x2F;data   # Remote directory for the data files</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line"># SQL node options:</span><br><span class="line">hostname&#x3D;192.168.50.129 # MySQL server&#x2F;client i manager</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line"># SQL node options:</span><br><span class="line">hostname&#x3D;192.168.50.128 # MySQL server&#x2F;client i manager</span><br></pre></td></tr></table></figure>
<ul>
<li>[NDB_MGMD] 表示管理节点的配置，只能有一个</li>
<li>[NDBD DEFAULT] 表示每个数据节点的默认配置，在每个节点的[NDBD]中不用再写这些选项，只能有一个</li>
<li>[NDBD] 表示每个数据节点的配置，可以有多个</li>
<li>[MYSQLD] 表示SQL节点的配置，可以有多个，分别写上不同的SQL节点的ip地址；如不写，只保留一个空节点，表示任意一个ip地址都可以进行访问。此节点的个数表明了可以用来连接数据节点的SQL节点总数</li>
<li>每个节点都有一个独立的id号，可以填写，比如nodeid=2，老版本使用id，新版本已经不使用id标识了。不填写，系统会按照配置文件的填写顺序自动分配</li>
</ul>
<img src="config-ini.png"></li>
<li><p>如果是生产环境，应该根据实际情况调整配置参数，参考MySQL Cluster. 你还可以增加 data nodes (ndbd) 或 MySQL server nodes (mysqld).</p>
</li>
<li><p>启动管理器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查看是否有正在运行的服务进程</span><br><span class="line">ps -aux | grep ndb_mgmd</span><br><span class="line"></span><br><span class="line"># 在启动服务前，可能需要杀掉正在运行的服务:</span><br><span class="line">sudo pkill -f ndb_mgmd</span><br><span class="line"></span><br><span class="line"># 启动服务</span><br><span class="line">sudo ndb_mgmd -f &#x2F;var&#x2F;lib&#x2F;mysql-cluster&#x2F;config.ini</span><br><span class="line"></span><br><span class="line">#检查ndb_mgmd 使用的端口 1186</span><br><span class="line">sudo netstat -plntu</span><br></pre></td></tr></table></figure>
<img src="startndb_mgmd.png"></li>
<li><p>配置<strong>自动加载服务</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 在Ubuntu虚拟机下</span><br><span class="line"># 打开并编辑下面 systemd Unit 文件</span><br><span class="line">sudo vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;ndb_mgmd.service</span><br><span class="line"></span><br><span class="line"># 键入以下内容，保存并关闭</span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;MySQL NDB Cluster Management Server</span><br><span class="line">After&#x3D;network.target auditd.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;forking</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;sbin&#x2F;ndb_mgmd -f &#x2F;var&#x2F;lib&#x2F;mysql-cluster&#x2F;config.ini</span><br><span class="line">ExecReload&#x3D;&#x2F;bin&#x2F;kill -HUP $MAINPID</span><br><span class="line">KillMode&#x3D;process</span><br><span class="line">Restart&#x3D;on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br><span class="line"></span><br><span class="line"># 上面只是加入了如何启动、停止和重启动ndb_mgmd进程的最小选项集合</span><br><span class="line"># more information，参阅[systemd manual](https:&#x2F;&#x2F;www.freedesktop.org&#x2F;software&#x2F;systemd&#x2F;man&#x2F;systemd.service.html).</span><br></pre></td></tr></table></figure>

<img src="ndbmgmdservice.png">

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># reload systemd’s manager configuration using daemon-reload</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"># enable the service we just created</span><br><span class="line"># MySQL Cluster Manager starts on reboot</span><br><span class="line">sudo systemctl enable ndb_mgmd</span><br><span class="line"></span><br><span class="line"># start the service</span><br><span class="line">sudo systemctl start ndb_mgmd</span><br><span class="line"></span><br><span class="line"># verify that the NDB Cluster Management service is running</span><br><span class="line">sudo systemctl status ndb_mgmd</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ndb_mgmd</code>MySQL Cluster Management server作为一个系统服务正在运行</li>
</ul>
<img src="systemctlenablendbmgmd.png"></li>
<li><p>设置<code>Cluster Manager</code>允许其它<code>MySQL Cluster</code>节点连入</p>
<ul>
<li>如果出现连接问题，则需要设置<code>ufw</code>防火墙，添加允许数据节点连入的规则<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo ufw allow from 192.168.50.128</span><br><span class="line">sudo ufw allow from 192.168.50.129</span><br></pre></td></tr></table></figure></li>
<li>会见到如下输出。此时<code>Cluster Manager</code>应该启动运行了，并且能够通过局域网与集群其它节点通信了。<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Rule added</span><br><span class="line"></span><br><span class="line"># 因为我之前配置过，所以会显示</span><br><span class="line">Rule updated</span><br></pre></td></tr></table></figure>
<h4 id="2-3-4-配置数据节点"><a href="#2-3-4-配置数据节点" class="headerlink" title="2.3.4 配置数据节点"></a>2.3.4 配置数据节点</h4></li>
</ul>
</li>
<li><p>假定在192.168.50.129上进行(同理另一个节点)</p>
</li>
<li><p>安装依赖包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 修复损坏的软件包，尝试卸载出错的包，重新安装正确版本的</span><br><span class="line">sudo apt-get –f install </span><br><span class="line">sudo apt install libclass-methodmaker-perl</span><br></pre></td></tr></table></figure></li>
<li><p>安装数据节点包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 进入install文件夹</span><br><span class="line">sudo dpkg -i mysql-cluster-community-data-node_8.0.19-1ubuntu16.04_amd64.deb</span><br></pre></td></tr></table></figure>
<img src="dpkg-data.png"></li>
<li><p>数据节点将从固定位置/etc/my.cnf获取配置文件.创建文件并编辑</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;my.cnf</span><br><span class="line"></span><br><span class="line"># 写入以下内容 两个虚拟机都一样</span><br><span class="line">[mysql_cluster]</span><br><span class="line"># Options for NDB Cluster processes:</span><br><span class="line">ndb-connectstring&#x3D;192.168.50.129  # location of cluster manager</span><br></pre></td></tr></table></figure>
<img src="myconf.png"></li>
<li><p>本配置设定在管理器配置数据目录为<code>/usr/local/mysql/data</code>。运行服务前要创建相关目录<code>sudo mkdir -p /usr/local/mysql/data</code>。在成功启动数据节点的时候，会向该文件夹中写入数据，如下图所示。</p>
<img src="data.png"></li>
<li><p>启动服务<code>sudo ndbd</code>，NDB 数据节点守护程序成功启动</p>
<img src="ndbstartsuccess.png">

<p>同理见<code>192.168.50.128</code>(192.168.50.129机器上的管理器服务要打开)</p>
<img src="ndbstartsuccess1.png"></li>
<li><p>如果出现连接问题，请打开防火墙：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo ufw allow from 192.168.50.129</span><br><span class="line">sudo ufw allow from 192.168.50.128</span><br></pre></td></tr></table></figure></li>
<li><p>同配置集群管理器类似，配置数据节点服务自启动</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打开并编辑如下 systemd Unit 文件</span><br><span class="line">sudo vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;ndbd.service</span><br><span class="line"></span><br><span class="line"># 内容如下：</span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;MySQL NDB Data Node Daemon</span><br><span class="line">After&#x3D;network.target auditd.service</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;forking</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;sbin&#x2F;ndbd</span><br><span class="line">ExecReload&#x3D;&#x2F;bin&#x2F;kill -HUP $MAINPID</span><br><span class="line">KillMode&#x3D;process</span><br><span class="line">Restart&#x3D;on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br><span class="line"></span><br><span class="line"># 采用daemon-reload重新加载systemd’s manager配置</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"># 让我们刚创建的服务生效，使data node daemon可以开机执行</span><br><span class="line">sudo systemctl enable ndbd</span><br><span class="line"></span><br><span class="line"># 启动服务</span><br><span class="line">sudo systemctl start ndbd</span><br><span class="line"></span><br><span class="line"># 禁止服务</span><br><span class="line">sudo systemctl stop ndbd</span><br><span class="line"></span><br><span class="line"># 验证NDB Cluster Management service服务正在执行</span><br><span class="line">sudo systemctl status ndbd</span><br></pre></td></tr></table></figure>
<img src="systemctlenablendbd.png"></li>
</ul>
<h4 id="2-3-5-配置并运行MySQL-Server和Client"><a href="#2-3-5-配置并运行MySQL-Server和Client" class="headerlink" title="2.3.5 配置并运行MySQL Server和Client"></a>2.3.5 配置并运行MySQL Server和Client</h4><ul>
<li><p>标准的MySQL server不支持 MySQL Cluster 引擎 NDB。这意味着我们需要安装含有定制的SQL服务器 MySQL Cluster软件。</p>
</li>
<li><p><code>192.168.50.129</code>和<code>192.168.50.128</code>都作为<code>MySQL Server node</code></p>
</li>
<li><p>进入包含MySQL Cluster组件的目录<code>cd install</code></p>
</li>
<li><p>在安装MySQL server 前，需要安装两个依赖库（如果已经安装过可忽略）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install libaio1 libmecab2</span><br></pre></td></tr></table></figure></li>
<li><p>安装解压在install目录的软件包中的一些MySQL Cluster依赖包</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &#x2F;install&#x2F;</span><br><span class="line">sudo dpkg -i mysql-common_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line">sudo dpkg -i mysql-cluster-community-client-core_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line">sudo dpkg -i mysql-cluster-community-client_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line">sudo dpkg -i mysql-client_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line">sudo dpkg -i mysql-cluster-community-server-core_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line">sudo dpkg -i mysql-cluster-community-server_8.0.19-1ubuntu16.04_amd64.deb</span><br><span class="line"></span><br><span class="line"># 此处若是出现依赖问题，输入以下命令，再重新执行一遍上面语句 </span><br><span class="line">sudo apt-get -f install</span><br><span class="line"># 或者把依赖包删除 重装一遍</span><br><span class="line">sudo apt-get purge libaio1 </span><br><span class="line">sudo apt-get purge libmecab2</span><br></pre></td></tr></table></figure></li>
<li><p>当安装mysql-cluster-community-server时，会出现配置提示，请求为mysql数据库root用户设置密码。在后面选项选择使用<strong>强安全密码</strong></p>
<img src="password.png">

<img src="strongpw.png"></li>
<li><p>安装MySQL server:<code>sudo dpkg -i mysql-server_8.0.19-1ubuntu16.04_amd64.deb</code></p>
<img src="installmysqlserver.png"></li>
<li><p>配置MySQL server</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打开MySQL Server 配置文件默认</span><br><span class="line">sudo vim &#x2F;etc&#x2F;mysql&#x2F;my.cnf</span><br></pre></td></tr></table></figure>
<ul>
<li><p>可看到下列文本</p>
<img src="mycnf.png"></li>
<li><p>往文本后追加(192.168.50.128填写的相同)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"># Options for mysqld process:</span><br><span class="line">ndbcluster  # run NDB storage engine</span><br><span class="line"></span><br><span class="line">[mysql_cluster]</span><br><span class="line"># Options for NDB Cluster processes:</span><br><span class="line">ndb-connectstring&#x3D;192.168.50.129  # location of management server</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>重启MySQL server，使上面的变化生效:<code>sudo systemctl restart mysql</code></p>
</li>
<li><p>MySQL默认开机自动启动。如果不能启动，下述命令可以修复:<code>sudo systemctl enable mysql</code></p>
</li>
</ul>
<h4 id="2-3-6-验证MySQL-Cluster安装"><a href="#2-3-6-验证MySQL-Cluster安装" class="headerlink" title="2.3.6 验证MySQL Cluster安装"></a>2.3.6 验证MySQL Cluster安装</h4><ul>
<li><p>为了验证MySQL Cluster正确安装, 登陆Cluster Manager / SQL Server节点，为192.168.50.129/192.168.50.128。</p>
</li>
<li><p>打开MySQL客户端连接到root账号：<code>mysql -u root -p</code></p>
<img src="startmysql.png"></li>
<li><p>在MySQL客户端中, 运行下列命令:<br><code>SHOW ENGINE NDB STATUS \G</code>，系统会显示NDB引擎的相关信息，表示成功连入MySQL Cluster</p>
<img src="NDB.png"></li>
<li><p><code>number of ready_data_nodes= 2</code></p>
<ul>
<li><p>如果一个数据节点挂了（本例中必须是那个没有安装MySQL Cluster管理器的节点），MySQL cluster还是可以继续工作</p>
</li>
<li><p>测试cluster的稳定性</p>
<ul>
<li><p>shutting down非管理器节点（192.168.50.128），在整个过程中看到<code>number_of_ready_data_nodes</code>从2变为1。</p>
<img src="numberofreadydatanodes.gif"></li>
<li><p>再次开启服务，又由1变为2(这个变化过程有延迟，需要等待一会)。同理停止管理器节点上的ndbd服务。</p>
<img src="fullprocess.gif"></li>
</ul>
</li>
</ul>
</li>
<li><p>在集群管理器控制台上查看集群信息，命令为：<code>ndb_mgm</code>。然后在集群管理器控制台输入<code>SHOW</code>，输出信息如下：</p>
<ul>
<li><p>192.168.50.128的数据节点ndbd断开连接的情况</p>
<img src="ndbmgm.png"></li>
</ul>
</li>
</ul>
<ul>
<li><p>192.168.50.128的数据节点ndbd未断开连接的情况</p>
<img src="ndbmgm1.png">

<p>192.168.50.128的mysql服务器启动</p>
<img src="mysqldallconnect.png"></li>
<li><p>退出MySQL客户端，使用quit或按CTRL-D</p>
</li>
<li><p>管理控制台功能很多，有很多其他的管理命令来管理集群和数据, 包括创建在线备份. 更多信息参考官方<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/mysql-cluster-management.html">official MySQL documentation</a></p>
</li>
</ul>
<h4 id="2-3-7-向MySQL集群插入数据"><a href="#2-3-7-向MySQL集群插入数据" class="headerlink" title="2.3.7 向MySQL集群插入数据"></a>2.3.7 向MySQL集群插入数据</h4><ul>
<li><p>注意为了使用集群功能, 必须使用NDB数据库引擎。如果使用InnoDB (default)或其他引擎,将不能使用集群。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打开MySQL客户端连接到root账号</span><br><span class="line">mysql -u root -p</span><br><span class="line"></span><br><span class="line"># 首先, 创建数据库clustertest:</span><br><span class="line">CREATE DATABASE clustertest;</span><br><span class="line"></span><br><span class="line"># 其次转到新数据库:</span><br><span class="line">USE clustertest;</span><br><span class="line"></span><br><span class="line"># 再次，创建表test_table:</span><br><span class="line"># 需要显式规定ndbcluster引擎</span><br><span class="line">CREATE TABLE test_table (name VARCHAR(20), value VARCHAR(20)) ENGINE&#x3D;ndbcluster;</span><br><span class="line"></span><br><span class="line"># 现在可以插入数据了:</span><br><span class="line">INSERT INTO test_table (name,value) VALUES(&#39;some_name&#39;,&#39;some_value&#39;);</span><br><span class="line"></span><br><span class="line"># 最后验证数据插入：</span><br><span class="line">SELECT * FROM test_table;</span><br><span class="line"></span><br><span class="line"># show databases</span><br></pre></td></tr></table></figure>
<img src="insertdata.png"></li>
<li><p><strong><a href="#251-ndb%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B5%8B%E8%AF%95">思考：在本例中，数据被插入到了哪个机器？</a></strong></p>
<ul>
<li>我认为数据应该被插入了本地机器</li>
<li>在此处数据备份为2的话，则另一个数据节点有一份相同的备份</li>
</ul>
</li>
<li><p>可以在my.cnf文件中设定默认数据存储引擎为ndbcluster，这样创建表时就不再规定引擎了。更多信息参考<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/storage-engine-setting.html">MySQL Reference Manual</a></p>
</li>
</ul>
<h3 id="2-4-结语"><a href="#2-4-结语" class="headerlink" title="2.4 结语"></a>2.4 结语</h3><p>至此我们在Ubuntu 16.04 servers上安装和配置了a MySQL Cluster。需要注意的是这是一个很小的简化体系结构来说明配置过程，部署一个生产环境，还有许多其他的选项和特征需要去学习.。更多信息请参阅 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/mysql-cluster.html">MySQL Cluster documentation</a></p>
<h3 id="2-5-验证可靠性"><a href="#2-5-验证可靠性" class="headerlink" title="2.5 验证可靠性"></a>2.5 验证可靠性</h3><h4 id="2-5-1-NDB存储引擎测试"><a href="#2-5-1-NDB存储引擎测试" class="headerlink" title="2.5.1 NDB存储引擎测试"></a>2.5.1 NDB存储引擎测试</h4><ul>
<li><p>在192.168.50.129的SQL节点创建数据库并且插入数据(一定要设置存储引擎为NDB)，在192.168.50.128的SQL节点可以查询到，<strong>两个SQL节点查询的数据时一致的，能够同步</strong></p>
<img src="databaseposition.png">

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use clustertest</span><br></pre></td></tr></table></figure>
<h4 id="2-5-2-单点故障测试"><a href="#2-5-2-单点故障测试" class="headerlink" title="2.5.2 单点故障测试"></a>2.5.2 单点故障测试</h4></li>
</ul>
<h5 id="SQL节点发生单点故障"><a href="#SQL节点发生单点故障" class="headerlink" title="SQL节点发生单点故障"></a>SQL节点发生单点故障</h5><ul>
<li><p>将SQL节点192.168.50.128上的MySQL服务停止</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;etc&#x2F;init.d&#x2F;mysqld stop</span><br><span class="line"># sudo systemctl stop mysql </span><br></pre></td></tr></table></figure></li>
<li><p>ndb_mgm查看cluster状态</p>
<img src="sqlnotonnect.png"></li>
<li><p>从SQL节点192.168.50.129上查看数据，正常</p>
<img src="onesqlfailed.png">

<img src="onesqlfailed.gif"></li>
<li><p>SQL节点的单点故障并没有引起数据查询的故障。对于应用来说，需要改变的就是将以前对故障节点的访问改为对非故障节点的访问</p>
</li>
</ul>
<h5 id="NDB-数据节点-单点故障"><a href="#NDB-数据节点-单点故障" class="headerlink" title="NDB(数据节点)单点故障"></a>NDB(数据节点)单点故障</h5><ul>
<li><p>在这个测试环境中，数据节点也是两个，那么他们对数据的存储是互相镜像还是一份数据分成几块存储呢？这个答案关键在于配置文件中[NDBD DEFAULT]组中的<strong>NoOfReplicas参数</strong>，如果这个参数等于1，表示只有一份数据，但是分成N块分别存储在N个数据节点上，如果该值等于2，则表示数据被分成N/2,每块数据都有两个备份，这样即使有任意一个节点发生故障，只要它的备份节点正常，数据就可以正常查询</p>
</li>
<li><p>将NDB节点192.168.50.129上的ndbd服务停止</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ps -ef | grep ndbd</span><br><span class="line">pkill -9 ndbd</span><br></pre></td></tr></table></figure></li>
<li><p>ndb_mgm查看cluster状态，NDB节点192.168.50.129上已经挂掉</p>
<img src="onendbfailed.png"></li>
<li><p>从SQL节点192.168.50.128和SQL节点192.168.50.129上查看数据，正常</p>
<img src="onenbdfailed.gif"></li>
<li><p>在此样例中，挂掉一个NDB节点不影响正常的数据查询，数据节点的冗余同样防止了NDB单点故障</p>
</li>
<li><p>如果该测试中，NoOfReplicas=1，如果有一个数据节点挂了，则无法正常访问完整数据</p>
</li>
</ul>
<h4 id="2-5-3-集群的关闭"><a href="#2-5-3-集群的关闭" class="headerlink" title="2.5.3 集群的关闭"></a>2.5.3 集群的关闭</h4><ul>
<li>关闭顺序：SQL节点-&gt;数据节点-&gt;管理节点</li>
<li>NDB节点和管理节点的关闭都可以在管理节点的管理程序中完成，也可以分节点关闭</li>
<li>关闭Cluster节点不会停止sql节点数据库服务</li>
<li>但在关闭整个MySQL Cluster环境(内部关闭：ndb_mgm&gt; shutdown)或者关闭某个SQL节点的时候，首先必须到SQL节点主机上来关闭SQL节点程序</li>
</ul>
<h3 id="2-6-思考问题"><a href="#2-6-思考问题" class="headerlink" title="2.6 思考问题"></a>2.6 思考问题</h3><ol>
<li>通过实验，你对一个分布式数据库系统有何理解？分布式数据库系统预计有何优越性？<ul>
<li>理解：分布在同一个网络；逻辑上属于同一个系统；物理上分布在不同的节点上</li>
<li>优越性：<ul>
<li>适合分布式数据管理，能有效地提高系统性能，吞吐率和响应速度提高</li>
<li>分布式数据库系统可利用现有的设备和系统，省时、省力、投资少</li>
<li>提高了系统的可用性、可靠性和并行执行度，并允许存储数据副本</li>
<li>根据实际需要，可增减某一场地，系统具有可扩展性</li>
<li>分布式数据库系统资源和数据分布在物理上不同的场地上，为系统所有用户共享</li>
</ul>
</li>
</ul>
</li>
<li><a href="#25-%E9%AA%8C%E8%AF%81%E5%8F%AF%E9%9D%A0%E6%80%A7">你能设计一个方案验证集群系统在可靠性上优于集中式数据库系统吗？</a><ul>
<li>集中式数据库，单点，崩了就完了</li>
</ul>
</li>
<li>同样是插入数据，你觉得MySQL Cluster和myCAT在实体完整性保持方面是否可能会有不同？为什么？<blockquote>
<p>Entity Integrity ensures that there are no duplicate records within the table and that the field that identifies each record within the table is unique and never null.</p>
</blockquote>
<ul>
<li>实体完整性要求每个数据表都必须有<strong>主键</strong>，而作为主键的所有字段，其属性必须是<strong>独一及非空值</strong></li>
<li>MySQL Cluster：auto-sharding，需要内存很大(被诟病)</li>
<li>myCAT: 分表分库，即将一个大表水平分割为 N个小表，存储在后端MySQL服务器里或者其他数据库里。早期myCAT没有检测，不同数据库的完整性无法保证，现在未知。</li>
</ul>
</li>
</ol>
<h2 id="3-问题与解决"><a href="#3-问题与解决" class="headerlink" title="3 问题与解决"></a>3 问题与解决</h2><ul>
<li><p>无法连接虚拟设备sata0:1</p>
<img src="cannotconnect.png">

<p>解决：修改虚拟机 -&gt; 右键设置硬件 -&gt; CD/DVD(SATA) -&gt; 使用 ISO 映像文件</p>
<p>但我认为这不影响虚拟机的使用所以就没深入解决</p>
</li>
<li><p>提供此类问题<code>temporary failure resolving cn.archive.ubuntu.com</code>的解决思路</p>
<img src="cannotresolve.png">

<ul>
<li>原因：无法解析该域名</li>
<li>试试<code>nslookup www.baidu.com</code></li>
<li>如果发现服务器的DNS没有配，则<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 打开配置文件</span><br><span class="line">vi &#x2F;etc&#x2F;resolv.conf</span><br><span class="line"></span><br><span class="line"># 添加</span><br><span class="line">nameserver 114.114.114.114</span><br><span class="line">nameserver 8.8.8.8</span><br><span class="line">nameserver 223.5.5.5</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>报错：该虚拟机似乎正在使用中。如果该虚拟机未在使用，请按”获取所有权(T)”按钮获取。获取所有权失败。原因:VM异常关闭导致。</p>
<img src="usingnow.png">

<p>解决：进入VM虚拟机的存放目录，删除后缀为.lck的文件</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Komorebi-john/p/11381053.html">VMware-以独占方式锁定此配置文件失败.另一个正在运行</a></p>
<ul>
<li>上述的方法都没有成功，通过<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34418601/article/details/91041411">在Windows程序与功能-&gt;修复vmware解决</a></li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.linuxidc.com/Linux/2015-06/119021.htm">每次重启虚拟机后，<code>/etc/resolv.conf</code>文件就要重新配置，之前的都被抹去</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># resolv.conf文件其实是一个Link文件</span><br><span class="line"># 在Ubuntu中有一个 resolvconf的服务，这个服务用来控制&#x2F;etc&#x2F;resolv.conf的内容</span><br><span class="line"># 一旦我们重启了系统或者该服务，那么&#x2F;etc&#x2F;resolv.conf文件中的内容将被还原为原来的内容</span><br><span class="line"></span><br><span class="line">sudo vi &#x2F;etc&#x2F;resolvconf&#x2F;resolv.conf.d&#x2F;base</span><br><span class="line"># [应用更改](https:&#x2F;&#x2F;www.zhoushangren.com&#x2F;archives&#x2F;779)</span><br><span class="line">sudo resolvconf -u</span><br></pre></td></tr></table></figure></li>
<li><p><code>ping: unknown host www.baidu.com</code>的解决方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ping 网关</span><br><span class="line">auto ens33</span><br><span class="line">iface ens33 inet dhcp</span><br></pre></td></tr></table></figure>
<h2 id="4-实验总结"><a href="#4-实验总结" class="headerlink" title="4 实验总结"></a>4 实验总结</h2></li>
<li><p>VMware挂起</p>
<ul>
<li>相当于物理机中的休眠，会将内存中的数据全部存放到对应的休眠文件中，占用的空间为内存大小，并且会对虚拟机执行关机操作</li>
<li>休眠后的虚拟机不占任何CPU、内存</li>
<li>相对于关机，只多了一个和内存大小相同的休眠文件</li>
</ul>
</li>
<li><p>VMware不像virtualbox可以从外部将虚拟机强行终止，VMware的虚拟机若是不正常关机，下一次启动会出现很多莫名其妙的问题。</p>
</li>
<li><p><code>sudo apt-get update</code>总是出问题的时候，通过科学上网、修改dns服务器、更改镜像源等操作后未果，可以不要选择大晚上执行命令，<del>太闹心，再也不做这种傻逼事</del>，放一放，换个时间可能会顺利很多。输入该命令之前可添加<code>sudo apt-get clean</code>，若是文件被锁住，则<code>ps -aux | grep apt*</code>获取有关进程的PID，然后<code>sudo kill PID</code>。</p>
</li>
<li><p>update和upgrade的区别：update是更新软件列表，upgrade是更新软件。在执行<code>upgrade</code>之前要先<code>update</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">update: 同步 &#x2F;etc&#x2F;apt&#x2F;sources.list 和 &#x2F;etc&#x2F;apt&#x2F;sources.list.d 中列出的源的索引</span><br><span class="line">upgrade：升级已安装的所有软件包，升级之后的版本就是本地索引里的</span><br></pre></td></tr></table></figure></li>
<li><p>apt和apt-get的区别</p>
<blockquote>
<p>apt = apt-get、apt-cache 和 apt-config 中最常用命令选项的集合</p>
<p>用 apt 替换部分 apt-get 系列命令，但不是全部</p>
</blockquote>
</li>
</ul>
<h2 id="5-参考资料"><a href="#5-参考资料" class="headerlink" title="5 参考资料"></a>5 参考资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huozf/p/9780747.html">在VMware Workstation中安装Ubuntu Server 16.04.5图解教程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.linuxidc.com/Linux/2017-04/143102.htm">为VMware虚拟机内安装的Ubuntu 16.04设置静态IP地址</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_31454611/article/details/80566002">SSH远程连接安装在VMware的Ubuntu16.0.4</a><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 查看虚拟机是否能够ping外网</span><br><span class="line"># 不行，配置DNS服务器 &#96;sudo vi &#x2F;etc&#x2F;resolv.conf&#96;</span><br><span class="line"># 重启网络sudo &#x2F;etc&#x2F;init.d&#x2F;networking restart</span><br><span class="line"># 检查当前的ssh开启情况</span><br><span class="line"># 如果有sshd，则ssh-server已经启动；若仅有agent，则尚未启动</span><br><span class="line">ps -e |grep ssh</span><br><span class="line"></span><br><span class="line"># 查看端口情况</span><br><span class="line">sudo netstat -plntu</span><br><span class="line"></span><br><span class="line"># 开启ssh服务</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;ssh start</span><br><span class="line"></span><br><span class="line"># 重启ssh</span><br><span class="line">sudo &#x2F;etc&#x2F;init.d&#x2F;ssh restart</span><br><span class="line"></span><br><span class="line"># 当主机ssh连接虚拟机出现ssh: connect to host 192.168.50.129 port 22: Connection timed out</span><br><span class="line"># 解决1:测试虚拟机是否能访问外网</span><br></pre></td></tr></table></figure></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gomysql/p/3664783.html">MySQL Cluster搭建与测试</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/JesseYoung/article/details/38726561">MySQL Cluster技术详解</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Purplezi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://purplezi.github.io/2020/03/25/MySQL-Cluster-set-up-configuration/">https://purplezi.github.io/2020/03/25/MySQL-Cluster-set-up-configuration/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/mysql/">mysql</a><a class="post-meta__tags" href="/tags/Cluster/">Cluster</a></div><div class="post_share"><div class="social-share" data-image="/img/bg2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/04/12/Number-Theory/"><img class="prev-cover" src="/img/bg2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Number Theory</div></div></a></div><div class="next-post pull-right"><a href="/2020/03/21/Windows-git-clone-slow/"><img class="next-cover" src="/img/bg2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Git 学习之路</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Purplezi</div><div class="author-info__description">DreamCreator & DreamLoser</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">23</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">1 实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">2 实验过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%89%8D%E6%8F%90"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 设置静态IP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-VMware%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 VMware配置网络环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E4%B8%BAUbuntu%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 为Ubuntu设置静态IP地址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87Terminal%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%9D%A5%E8%AE%BE%E7%BD%AEIP%E5%9C%B0%E5%9D%80"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">通过Terminal命令行来设置IP地址</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 集群配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E8%A6%81%E6%B1%82"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 集群配置要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E5%87%86%E5%A4%87%E9%98%B6%E6%AE%B5"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 准备阶段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E9%9B%86%E7%BE%A4%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">2.3.3.</span> <span class="toc-text">2.3.3 安装配置集群管理器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E8%8A%82%E7%82%B9"><span class="toc-number">2.3.4.</span> <span class="toc-text">2.3.4 配置数据节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5-%E9%85%8D%E7%BD%AE%E5%B9%B6%E8%BF%90%E8%A1%8CMySQL-Server%E5%92%8CClient"><span class="toc-number">2.3.5.</span> <span class="toc-text">2.3.5 配置并运行MySQL Server和Client</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-6-%E9%AA%8C%E8%AF%81MySQL-Cluster%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.6.</span> <span class="toc-text">2.3.6 验证MySQL Cluster安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-7-%E5%90%91MySQL%E9%9B%86%E7%BE%A4%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.7.</span> <span class="toc-text">2.3.7 向MySQL集群插入数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E7%BB%93%E8%AF%AD"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 结语</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E9%AA%8C%E8%AF%81%E5%8F%AF%E9%9D%A0%E6%80%A7"><span class="toc-number">2.5.</span> <span class="toc-text">2.5 验证可靠性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-NDB%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B5%8B%E8%AF%95"><span class="toc-number">2.5.1.</span> <span class="toc-text">2.5.1 NDB存储引擎测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-%E5%8D%95%E7%82%B9%E6%95%85%E9%9A%9C%E6%B5%8B%E8%AF%95"><span class="toc-number">2.5.2.</span> <span class="toc-text">2.5.2 单点故障测试</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#SQL%E8%8A%82%E7%82%B9%E5%8F%91%E7%94%9F%E5%8D%95%E7%82%B9%E6%95%85%E9%9A%9C"><span class="toc-number">2.5.2.1.</span> <span class="toc-text">SQL节点发生单点故障</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#NDB-%E6%95%B0%E6%8D%AE%E8%8A%82%E7%82%B9-%E5%8D%95%E7%82%B9%E6%95%85%E9%9A%9C"><span class="toc-number">2.5.2.2.</span> <span class="toc-text">NDB(数据节点)单点故障</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3-%E9%9B%86%E7%BE%A4%E7%9A%84%E5%85%B3%E9%97%AD"><span class="toc-number">2.5.3.</span> <span class="toc-text">2.5.3 集群的关闭</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E6%80%9D%E8%80%83%E9%97%AE%E9%A2%98"><span class="toc-number">2.6.</span> <span class="toc-text">2.6 思考问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3"><span class="toc-number">3.</span> <span class="toc-text">3 问题与解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%9E%E9%AA%8C%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">4 实验总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">5.</span> <span class="toc-text">5 参考资料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/04/14/hello-world/" title="Hello World"><img src="/img/bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2021/04/14/hello-world/" title="Hello World">Hello World</a><time datetime="2021-04-14T02:53:22.346Z" title="Created 2021-04-14 02:53:22">2021-04-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/13/douban-robot/" title="豆瓣自动回贴机器人【我没有用来干坏事呀~】"><img src="/img/bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="豆瓣自动回贴机器人【我没有用来干坏事呀~】"/></a><div class="content"><a class="title" href="/2021/04/13/douban-robot/" title="豆瓣自动回贴机器人【我没有用来干坏事呀~】">豆瓣自动回贴机器人【我没有用来干坏事呀~】</a><time datetime="2021-04-13T21:52:48.000Z" title="Created 2021-04-13 21:52:48">2021-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/03/digital-images-tampering-introduce/" title="数字图像篡改取证整理"><img src="/img/bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数字图像篡改取证整理"/></a><div class="content"><a class="title" href="/2021/04/03/digital-images-tampering-introduce/" title="数字图像篡改取证整理">数字图像篡改取证整理</a><time datetime="2021-04-03T10:58:51.000Z" title="Created 2021-04-03 10:58:51">2021-04-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/19/Linux-fundamental/" title="入门 Linux"><img src="/img/bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="入门 Linux"/></a><div class="content"><a class="title" href="/2021/03/19/Linux-fundamental/" title="入门 Linux">入门 Linux</a><time datetime="2021-03-19T18:02:58.000Z" title="Created 2021-03-19 18:02:58">2021-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/13/binary-search/" title="二分查找【binary search】"><img src="/img/bg2.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="二分查找【binary search】"/></a><div class="content"><a class="title" href="/2021/03/13/binary-search/" title="二分查找【binary search】">二分查找【binary search】</a><time datetime="2021-03-13T18:34:20.000Z" title="Created 2021-03-13 18:34:20">2021-03-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Purplezi</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="/js/randombg.js"></script><script defer src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>